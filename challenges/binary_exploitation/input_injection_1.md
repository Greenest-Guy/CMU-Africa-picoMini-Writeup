## Input Injection 1
**Category:** Binary Exploitation

**Files/Links Provided:** ```vuln.c```, ```vuln```


**Description:**  

```
A friendly program wants to greet you‚Ä¶ but its goodbye
might say more than it should. Can you convince it to
reveal the flag?
```

**Steps to Solve:**  
1. Download ```vuln.c``` and open in a text editor.
2. ```fgets(name, sizeof(name), stdin)``` allows for up to 199 bytes of input but ```fun()``` copies the input using ```strcpy() (no bounds checking)``` into buffer which is 10 bytes, so an input >10 bytes will overflow buffer.
3. Connect to the challenge instance ```nc <host> <port>```.
4. Try a test input which reveals that ```system()``` is executed with the command ```uname```, which outputs Linux, the host's OS.
5. Using an input such as ```0123456789echo "injection"``` echos injection to the terminal, verifying the vulnerability.
6. Reconnect to the server then input ```0123456789ls``` which reveals ```flag.txt```.
7. Finally, after using the input ```0123456789cat flag.txt``` the flag will be displayed in the terminal.

**Code / Commands / Images**

```c
// vuln.c source code
#include <string.h>
#include <stdio.h>
#include <stdlib.h> 

void fun(char *name, char *cmd);

int main() {
    char name[200];
    printf("What is your name?\n");
    fflush(stdout);


    fgets(name, sizeof(name), stdin);
    name[strcspn(name, "\n")] = 0;

    fun(name, "uname");
    return 0;
}

void fun(char *name, char *cmd) {
    char c[10];
    char buffer[10];

    strcpy(c, cmd);
    strcpy(buffer, name);

    printf("Goodbye, %s!\n", buffer);
    fflush(stdout);
    system(c);
}

```
[üè† Back to Main Page](https://github.com/Greenest-Guy/CMU-Africa-picoMini-Writeup)
